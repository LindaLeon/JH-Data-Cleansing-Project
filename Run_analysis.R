library(dplyr)
ActivityDesc<-read.table("activity_labels.txt")
FeatureVar<-read.table("features.txt")
Xtest<-read.table("./test/X_test.txt")
ytest<-read.table("./test/y_test.txt")
ytest<-rename(ytest,ActivityNum=V1)
subjecttest<-read.table("./test/subject_test.txt")
subjecttest<-rename(subjecttest,SubjectID=V1)
test1<-cbind(ytest,Xtest)
testdata<-cbind(subjecttest,test1)
Xtrain<-read.table("./train/X_train.txt")
ytrain<-read.table("./train/y_train.txt")
ytrain<-rename(ytrain,ActivityNum=V1)
subjecttrain<-read.table("./train/subject_train.txt")
subjecttrain<-rename(subjecttrain,SubjectID=V1)
train1<-cbind(ytrain,Xtrain)
traindata<-cbind(subjecttrain,train1)
projectDataset<-rbind(testdata,traindata)
step2subset<-grep("*mean*|*std*",FeatureVar$V2)
step2subsetcol<-step2subset+2
Step2Dataset<-select(projectDataset,SubjectID:ActivityNum)
Step3Dataset<-merge(Step2Dataset,ActivityDesc,by.x="ActivityNum",by.y="V1")
Step3Dataset<-rename(Step3Dataset,Activity=V2)
Step3Dataset<-select(Step3Dataset,SubjectID:Activity)
colsubset<-select(projectDataset,step2subsetcol)
DescColnames<-FeatureVar[step2subset,2]
DescColnames<-gsub("-","",DescColnames)
DescColnames<-gsub("()","",DescColnames,fixed=TRUE)
colnames(colsubset)<-DescColnames
Step4Dataset<-cbind(Step3Dataset,colsubset)
Step5Dataset<-Step4Dataset
Step5TidyDataset<-Step5Dataset%>%group_by(SubjectID,Activity)%>%summarise_each(funs(mean))
dim(Step5TidyDataset)
names(Step5TidyDataset)